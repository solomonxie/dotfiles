# Owner: Solomon Xie
# Email: solomonxiewise@gmail.com
# Original Author: louiszhai
# Reference link: http://louiszhai.github.io/2017/09/30/tmux/
# Preload:
#     $ sudo git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
#     $ brew install reattach-to-user-namespace
# Commands (Must be run within Tmux after initialization):
#     $ tmux source-file ~/.tmux.conf
#
#


#<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
# TPM - Tmux Plugin Manager (Tmux v2.1+) ------{{{
    # List of plugins
    set -g @plugin 'tmux-plugins/tpm'
    set -g @plugin 'tmux-plugins/tmux-sensible'
    
    # Tmux-Resurrect + Tmux-Continuum
    set -g @plugin 'tmux-plugins/tmux-resurrect'
    set -g @plugin 'tmux-plugins/tmux-continuum'
# }}}
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>


# 基础设置 {{{
    #set -g default-terminal "screen-256color"
    set -g default-terminal "xterm-256color"     # recover colorful terminal
    set -g display-time 3000
    set -g escape-time 0
    set -g history-limit 65535
    set -g base-index 1
    set -g pane-base-index 1
    set-option -g allow-rename off  # don't rename windows automatically
    # 恢复用户空间
    # tmux会话中，Mac的部分命令如 osascript、open、pbcopy 或 pbpaste等
    #可能会失效（失效命令未列全）
    #对此，我们可以通过安装reattach-to-user-namespace包装程序来解决这个问题
    if-shell 'test "$(uname -s)" = Darwin' 'set-option -g default-command "exec reattach-to-user-namespace -l $SHELL"'
# }}}


# 开启鼠标支持 --------{{{
    # (tmux v2.1+)
    set-option -g mouse on 
    # (低于tmux 2.1)
    setw -g mouse-resize-pane on
    setw -g mouse-select-pane on
    setw -g mouse-select-window on
    setw -g mode-mouse on
    set-window-option -g mode-mouse on
# }}}

# Key binding --------------{{{
    # 绑定快捷键为r
    bind r source-file ~/.tmux.conf \; display-message "Config reloaded.."
    # 选中窗口
    # 绑定hjkl键为面板切换的上下左右键
    bind -r k select-pane -U # 绑定k为↑
    bind -r j select-pane -D # 绑定j为↓
    bind -r h select-pane -L # 绑定h为←
    bind -r l select-pane -R # 绑定l为→
    # 新增面板
    unbind '"'
    bind | splitw -v -c '#{pane_current_path}' # 上下分割面板，默认进入当前目录
    unbind %
    bind - splitw -h -c '#{pane_current_path}' # 左右分割面板，默认进入当前目录
    # Statusbar
    bind-key c new-window -n 'shell'
    # 修改指令前缀
    #set -g prefix C-a #
    #bind C-a send-prefix # 绑定Ctrl+a为新的指令前缀
    #set -g prefix C-b
# }}}



# Tmux-Resurrect + Tmux-Continuum ----------------------{{{
    set -g @resurrect-save-bash-history 'on'  # 保存命令历史
    set -g @resurrect-capture-pane-contents 'on'  # 保存屏幕内容
    set -g @resurrect-strategy-vim 'session'
    # set -g @resurrect-save 'S'
    # set -g @resurrect-restore 'R'
    # tmux-continuum
    set -g @continuum-save-interval '5' # 每5分钟备份一次
    set -g @continuum-restore 'on'
# }}}

######################
### DESIGN CHANGES ###
######################

# Status bar --------------------{{{ 
    set -g status-bg black
    set -g status-fg white
    set-option -g status-justify centre
    set-option -g status-left '#[fg=cyan][#{session_name}]'
    set-option -g status-left-length 25
    set-option -g status-right '#[fg=white,bg=default]%H:%M #[default] #[fg=blue]%Y-%m-%d%a'
    
    # window
    setw -g automatic-rename off
    set-option -g allow-rename off
    set-window-option -g window-status-fg brightblue
    set-window-option -g window-status-bg default
    set-window-option -g window-status-current-style fg='#333333',bg="#ff9966"
    set-window-option -g clock-mode-colour black
    set-window-option -g clock-mode-style 24
    
    set-window-option -g monitor-activity on
    set-window-option -g visual-bell off
    set-window-option -g bell-action other
    
    # message text
    set-option -g message-style fg=colour5
    set-option -g message-style bg=colour232

# }}}

# panel --------------------{{{ 
    set-option -g pane-border-fg colour27
    set-option -g pane-active-border-fg colour9
    set-option -g display-panes-active-colour blue
    set-option -g display-panes-colour brightred
# }}}







#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# (keep this line at the very bottom of tmux.conf)
# Initialize TMUX plugin manager
run '~/.tmux/plugins/tpm/tpm'
